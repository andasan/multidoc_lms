var ee=Object.defineProperty;var te=(a,t,e)=>t in a?ee(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var F=(a,t,e)=>te(a,typeof t!="symbol"?t+"":t,e);import{o as c,c as p,a as s,b as C,k as R,l as K,t as g,r as x,f as P,x as se,P as j,p as v,n as w,h as l,m as G,i as I,F as U,J as H,Q as oe,j as J,_ as ne,u as re,y as le,K as ie,L as ae,U as ue}from"./index-0NdCcII0.js";import{u as Y}from"./use-students-BIfwdX0S.js";import{f as de}from"./date-utils-t9SKoCgA.js";function ce(a,t){return c(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function pe(a,t){return c(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function ge(a,t){return c(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"})])}const me={class:"bg-white p-6 shadow"},he={class:"flex items-center"},ve={class:"p-3 rounded-full bg-blue-100 text-blue-600"},fe={class:"ml-4"},we={class:"text-gray-500 text-sm font-medium"},ye={key:0,class:"text-2xl font-semibold text-gray-900"},xe={key:1,class:"text-2xl font-semibold text-gray-400"},Q=C({__name:"StatsCard",props:{title:{},value:{},icon:{},isLoading:{type:Boolean}},setup(a){const t={users:ge,"check-circle":ce,clock:pe};return(e,o)=>(c(),p("div",me,[s("div",he,[s("div",ve,[(c(),R(K(t[e.icon]),{class:"w-6 h-6"}))]),s("div",fe,[s("h3",we,g(e.title),1),e.isLoading?(c(),p("p",xe,"Loading...")):(c(),p("p",ye,g(e.value),1))])])]))}});class ke{constructor(){F(this,"sortStrategies",{string:(t,e,o)=>o==="asc"?t.localeCompare(e):e.localeCompare(t),number:(t,e,o)=>o==="asc"?t-e:e-t,date:(t,e,o)=>o==="asc"?t.getTime()-e.getTime():e.getTime()-t.getTime()})}getSortValue(t){return t===null?null:t instanceof Date||typeof t=="number"?t:String(t)}compareValues(t,e,o){return t===null&&e===null?0:t===null?1:e===null?-1:typeof t=="string"&&typeof e=="string"?this.sortStrategies.string(t,e,o):typeof t=="number"&&typeof e=="number"?this.sortStrategies.number(t,e,o):t instanceof Date&&e instanceof Date?this.sortStrategies.date(t,e,o):0}sort(t,e,o){return[...t].sort((n,i)=>{const d=this.getSortValue(n[e]),r=this.getSortValue(i[e]);return this.compareValues(d,r,o)})}}function be(a,t,e){const o=x(""),n=x("user_registered"),i=x("desc"),d=x(1),r=x(20),u=x(null),m=new ke,k=P(()=>{const h=a.value.filter(S=>S.display_name.toLowerCase().includes(o.value.toLowerCase())||S.user_email.toLowerCase().includes(o.value.toLowerCase()));return m.sort(h,n.value,i.value)}),L=P(()=>{const h=(d.value-1)*r.value,S=h+r.value;return k.value.slice(h,S)}),T=P(()=>Math.ceil(k.value.length/r.value)),E=h=>{n.value===h?i.value=i.value==="asc"?"desc":"asc":(n.value=h,i.value="asc"),b()},b=()=>{t.push({query:{...e.query,page:d.value.toString(),perPage:r.value.toString(),sort:n.value,order:i.value,search:o.value||void 0}})},N=()=>{d.value<T.value&&(d.value++,b())},M=()=>{d.value>1&&(d.value--,b())},B=h=>{d.value=h,b()},V=h=>{u.value=u.value===h?null:h};return se(o,()=>{d.value=1,b()}),{searchQuery:o,sortColumn:n,sortDirection:i,currentPage:d,itemsPerPage:r,filteredAndSortedStudents:k,paginatedStudents:L,totalPages:T,toggleSort:E,updateURL:b,nextPage:N,prevPage:M,goToPage:B,openDropdownId:u,toggleDropdown:V}}/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var z={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=({size:a,strokeWidth:t=2,absoluteStrokeWidth:e,color:o,iconNode:n,name:i,class:d,...r},{slots:u})=>j("svg",{...z,width:a||z.width,height:a||z.height,stroke:o||z.stroke,"stroke-width":e?Number(t)*24/Number(a):t,class:["lucide",`lucide-${_e(i??"icon")}`],...r},[...n.map(m=>j(...m)),...u.default?[u.default()]:[]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=(a,t)=>(e,{slots:o})=>j(Se,{...e,iconNode:t,name:a},o);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=$("ArrowUpDownIcon",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=$("ChevronDownIcon",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=$("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=$("ChevronRightIcon",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=$("ChevronUpIcon",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=$("EllipsisIcon",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),Le={class:"bg-blue-50"},Te={class:"flex items-center"},Ae={class:"flex items-center"},ze={class:"flex items-center"},Ee={class:"flex items-center"},Ne={class:"flex items-center"},Me=C({__name:"StudentTableHeader",props:{sortColumn:{},sortDirection:{}},emits:["toggle-sort"],setup(a,{emit:t}){const e=t;return(o,n)=>(c(),p("thead",Le,[s("tr",null,[s("th",{onClick:n[0]||(n[0]=i=>e("toggle-sort","ID")),scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer"},[s("div",Te,[n[5]||(n[5]=s("span",null,"ID",-1)),v(l(D),{class:w([{"text-blue-500":o.sortColumn==="ID"},"ml-1 h-4 w-4"])},null,8,["class"])])]),s("th",{onClick:n[1]||(n[1]=i=>e("toggle-sort","display_name")),scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer"},[s("div",Ae,[n[6]||(n[6]=s("span",null,"Name",-1)),v(l(D),{class:w([{"text-blue-500":o.sortColumn==="display_name"},"ml-1 h-4 w-4"])},null,8,["class"])])]),s("th",{onClick:n[2]||(n[2]=i=>e("toggle-sort","user_email")),scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer"},[s("div",ze,[n[7]||(n[7]=s("span",null,"Email",-1)),v(l(D),{class:w([{"text-blue-500":o.sortColumn==="user_email"},"ml-1 h-4 w-4"])},null,8,["class"])])]),s("th",{onClick:n[3]||(n[3]=i=>e("toggle-sort","quizAttempts")),scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer"},[s("div",Ee,[n[8]||(n[8]=s("span",null,"Quiz Status",-1)),v(l(D),{class:w([{"text-blue-500":o.sortColumn==="quizAttempts"},"ml-1 h-4 w-4"])},null,8,["class"])])]),s("th",{onClick:n[4]||(n[4]=i=>e("toggle-sort","user_registered")),scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer"},[s("div",Ne,[n[9]||(n[9]=s("span",null,"Enrollment Date",-1)),v(l(D),{class:w([{"text-blue-500":o.sortColumn==="user_registered"},"ml-1 h-4 w-4"])},null,8,["class"])])]),n[10]||(n[10]=s("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions",-1))])]))}}),Be={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ve={class:"flex items-center"},qe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Qe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},je={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Re={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Ue={class:"relative inline-block text-left"},He={class:"py-1"},Ze={key:0},Oe={colspan:"5",class:"px-6 py-4 bg-blue-50"},Fe={class:"text-sm text-gray-700"},Ge={key:0},Ke={key:1},Je=C({__name:"StudentTableRow",props:{student:{},isExpanded:{type:Boolean},isHighlighted:{type:Boolean},openDropdownId:{}},emits:["toggle-expand","navigate-to-student","toggle-dropdown"],setup(a,{emit:t}){const e=t,o=(r,u)=>{u.stopPropagation(),e("toggle-dropdown",r)},n=r=>!r.quizAttempts||r.quizAttempts.length===0?"Not Attempted":"Attempted",i=(r,u)=>{const m=k=>{r.value&&!r.value.contains(k.target)&&u()};H(()=>{document.addEventListener("click",m)}),oe(()=>{document.removeEventListener("click",m)})},d=x(null);return i(d,()=>{e("toggle-dropdown","")}),(r,u)=>(c(),p(U,null,[s("tr",{class:w({"bg-blue-100":r.isHighlighted})},[s("td",Be,g(r.student.ID),1),s("td",{onClick:u[0]||(u[0]=m=>e("toggle-expand",r.student.ID.toString())),class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 cursor-pointer"},[s("div",Ve,[s("span",null,g(r.student.display_name),1),(c(),R(K(r.isExpanded?l(De):l(Pe)),{class:"ml-2 h-4 w-4"}))])]),s("td",qe,g(r.student.user_email),1),s("td",Qe,[s("span",{class:w({"bg-green-600 text-gray-100":n(r.student)==="Attempted","bg-gray-100 text-gray-800":n(r.student)==="Not Attempted","px-2 py-1 rounded-full text-xs font-medium":!0})},g(n(r.student)),3)]),s("td",je,g(r.student.enrollment_date?l(de)(r.student.enrollment_date,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Not enrolled yet"),1),s("td",Re,[s("div",Ue,[s("button",{onClick:u[1]||(u[1]=m=>o(r.student.ID.toString(),m)),type:"button",class:"bg-white rounded-md p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500"},[u[4]||(u[4]=s("span",{class:"sr-only"},"Open options",-1)),v(l(Ie),{class:"h-5 w-5"})]),r.openDropdownId===r.student.ID.toString()?(c(),p("div",{key:0,ref_key:"dropdownRef",ref:d,onClick:u[3]||(u[3]=G(()=>{},["stop"])),class:"origin-top-right absolute right-full mr-2 -mt-6 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 divide-y divide-gray-100 focus:outline-none"},[s("div",He,[s("a",{href:"#",onClick:u[2]||(u[2]=G(m=>e("navigate-to-student",r.student.ID.toString()),["prevent"])),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},"View Details")])],512)):I("",!0)])])],2),r.isExpanded?(c(),p("tr",Ze,[u[6]||(u[6]=s("td",{class:"bg-blue-50"},null,-1)),s("td",Oe,[s("div",Fe,[u[5]||(u[5]=s("p",null,[s("strong",null,"Student Details:")],-1)),s("p",null,"ID: "+g(r.student.ID),1),s("p",null,"Name: "+g(r.student.display_name),1),s("p",null,"Email: "+g(r.student.user_email),1),r.student.birthDate?(c(),p("p",Ge,"Birthday: "+g(r.student.birthDate),1)):I("",!0),r.student.enrollment_date?(c(),p("p",Ke,"Invoice Issued: "+g(r.student.invoice_number?"Yes":"No"),1)):I("",!0)])])])):I("",!0)],64))}}),Ye={class:"flex flex-col sm:flex-row justify-between items-center mt-6 px-4 pb-5"},Xe={class:"text-sm text-gray-600 mb-4 sm:mb-0"},We={class:"flex items-center space-x-1"},et=["disabled"],tt=["onClick"],st=["disabled"],ot=C({__name:"StudentTablePagination",props:{currentPage:{},totalPages:{},itemsPerPage:{},filteredAndSortedStudents:{}},emits:["prev-page","next-page","go-to-page"],setup(a,{emit:t}){const e=t;return(o,n)=>(c(),p("div",Ye,[s("div",Xe," Showing "+g((o.currentPage-1)*o.itemsPerPage+1)+" to "+g(Math.min(o.currentPage*o.itemsPerPage,o.filteredAndSortedStudents.length))+" of "+g(o.filteredAndSortedStudents.length)+" entries ",1),s("div",We,[s("button",{onClick:n[0]||(n[0]=i=>e("prev-page")),disabled:o.currentPage===1,class:w(["pagination-button",{"opacity-50 cursor-not-allowed":o.currentPage===1}])},[v(l(Ce),{class:"h-5 w-5"})],10,et),(c(!0),p(U,null,J(o.totalPages,i=>(c(),p("div",{key:i,class:"hidden sm:block"},[s("button",{onClick:d=>e("go-to-page",i),class:w(["pagination-button",{"bg-blue-500 text-white":o.currentPage===i}])},g(i),11,tt)]))),128)),s("button",{onClick:n[1]||(n[1]=i=>e("next-page")),disabled:o.currentPage===o.totalPages,class:w(["pagination-button",{"opacity-50 cursor-not-allowed":o.currentPage===o.totalPages}])},[v(l($e),{class:"h-5 w-5"})],10,st)])]))}}),nt=ne(ot,[["__scopeId","data-v-3b44fa83"]]),rt={class:"w-full"},lt={class:"flex items-center justify-between p-4"},it={key:0,class:"text-center py-4"},at={key:1,class:"text-center py-4 text-red-500"},ut={key:2,class:"border-t"},dt={class:"w-full overflow-x-auto"},ct={class:"min-w-full divide-y divide-gray-200"},pt={class:"bg-white divide-y divide-gray-200"},gt=C({__name:"StudentTable",setup(a){const t=re(),e=le(),{students:o,isLoading:n,error:i,loadStudents:d}=Y(),{searchQuery:r,sortColumn:u,sortDirection:m,currentPage:k,itemsPerPage:L,filteredAndSortedStudents:T,paginatedStudents:E,totalPages:b,toggleSort:N,nextPage:M,prevPage:B,goToPage:V,openDropdownId:h,toggleDropdown:S}=be(o,t,e),A=x(null),q=x(null),X=y=>{A.value===y?(A.value=null,q.value=null):(A.value=y,q.value=y)},W=y=>{t.push(`/students/${y}`)};return H(()=>{const{page:y,perPage:_,sort:f,order:Z,search:O}=e.query;y&&(k.value=parseInt(y,10)),_&&(L.value=parseInt(_,10)),f&&typeof f=="string"&&(u.value=f),Z&&(m.value=Z),O&&(r.value=O)}),(y,_)=>(c(),p("div",rt,[s("div",lt,[ie(s("input",{"onUpdate:modelValue":_[0]||(_[0]=f=>ue(r)?r.value=f:null),type:"text",placeholder:"Search students...",class:"bg-white max-w-sm border rounded px-2 py-1"},null,512),[[ae,l(r)]]),s("button",{onClick:_[1]||(_[1]=(...f)=>l(d)&&l(d)(...f)),class:"bg-blue-500 text-white px-4 py-2 rounded"}," Refresh ")]),l(n)?(c(),p("div",it,"Loading...")):l(i)?(c(),p("div",at,g(l(i)),1)):(c(),p("div",ut,[s("div",dt,[s("table",ct,[v(Me,{sortColumn:l(u),sortDirection:l(m),onToggleSort:l(N)},null,8,["sortColumn","sortDirection","onToggleSort"]),s("tbody",pt,[(c(!0),p(U,null,J(l(E),f=>(c(),R(Je,{key:f.ID,student:f,isExpanded:A.value===f.ID.toString(),isHighlighted:q.value===f.ID.toString(),openDropdownId:l(h),onToggleExpand:X,onNavigateToStudent:W,onToggleDropdown:l(S)},null,8,["student","isExpanded","isHighlighted","openDropdownId","onToggleDropdown"]))),128))])])])])),v(nt,{currentPage:l(k),totalPages:l(b),itemsPerPage:l(L),filteredAndSortedStudents:l(T),onPrevPage:l(B),onNextPage:l(M),onGoToPage:l(V)},null,8,["currentPage","totalPages","itemsPerPage","filteredAndSortedStudents","onPrevPage","onNextPage","onGoToPage"])]))}});function mt(a){const t=P(()=>a.value.length),e=P(()=>a.value.reduce((n,i)=>n+i.quizAttempts.filter(d=>d.attempt_status==="attempt_ended").length,0)),o=P(()=>a.value.reduce((n,i)=>n+i.quizAttempts.filter(d=>Number(d.earned_marks)>=50).length,0));return{totalStudents:t,completedQuizzes:e,passedQuizzes:o}}const ht={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},vt={key:0,class:"bg-white shadow-md"},kt=C({__name:"Dashboard",setup(a){const{students:t,isLoading:e,error:o,loadStudents:n}=Y(),{totalStudents:i,completedQuizzes:d,passedQuizzes:r}=mt(t);return H(n),(u,m)=>(c(),p("div",null,[s("div",ht,[v(Q,{title:"Total Students",value:l(i),icon:"users",isLoading:l(e)},null,8,["value","isLoading"]),v(Q,{title:"Completed Quizzes",value:l(d),icon:"check-circle",isLoading:l(e)},null,8,["value","isLoading"]),v(Q,{title:"Passed Quizzes",value:l(r),icon:"clock",isLoading:l(e)},null,8,["value","isLoading"])]),l(o)?I("",!0):(c(),p("div",vt,[v(gt)]))]))}});export{kt as default};
